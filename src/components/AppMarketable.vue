<template>
  <div id="app">
    <b-form inline id="marketableForm" ref="marketableForm">
      <b-form-group>
        <b-form-select v-model="worldName" id="worldName">
          <b-form-select-option value="é™†è¡Œé¸Ÿ" style="font-weight: bold;font-style: italic;">é™†è¡Œé¸Ÿ
          </b-form-select-option>
          <b-form-select-option value="æ‹‰è¯ºè¥¿äºš">æ‹‰è¯ºè¥¿äºš</b-form-select-option>
          <b-form-select-option value="å¹»å½±ç¾¤å²›">å¹»å½±ç¾¤å²›</b-form-select-option>
          <b-form-select-option value="ç¥æ„ä¹‹åœ°">ç¥æ„ä¹‹åœ°</b-form-select-option>
          <b-form-select-option value="èŒèŠ½æ± ">èŒèŠ½æ± </b-form-select-option>
          <b-form-select-option value="çº¢ç‰æµ·">çº¢ç‰æµ·</b-form-select-option>
          <b-form-select-option value="å®‡å®™å’ŒéŸ³">å®‡å®™å’ŒéŸ³</b-form-select-option>
          <b-form-select-option value="æ²ƒä»™æ›¦æŸ“">æ²ƒä»™æ›¦æŸ“</b-form-select-option>
          <b-form-select-option value="æ™¨æ›¦ç‹åº§">æ™¨æ›¦ç‹åº§</b-form-select-option>
          <b-form-select-option value="çŒ«å°èƒ–" style="font-weight: bold;font-style: italic;">çŒ«å°èƒ–
          </b-form-select-option>
          <b-form-select-option value="ç´«æ°´æ ˆæ¡¥">ç´«æ°´æ ˆæ¡¥</b-form-select-option>
          <b-form-select-option value="æ‘©æœçº³">æ‘©æœçº³</b-form-select-option>
          <b-form-select-option value="æµ·çŒ«èŒ¶å±‹">æµ·çŒ«èŒ¶å±‹</b-form-select-option>
          <b-form-select-option value="ç¥ç€åŸ">ç¥ç€åŸ</b-form-select-option>
          <b-form-select-option value="é™è¯­åº„å›­">é™è¯­åº„å›­</b-form-select-option>
          <b-form-select-option value="å»¶å¤">å»¶å¤</b-form-select-option>
          <b-form-select-option value="æŸ”é£æµ·æ¹¾">æŸ”é£æµ·æ¹¾</b-form-select-option>
          <b-form-select-option value="è«å¤åŠ›" style="font-weight: bold;font-style: italic;">è«å¤åŠ›
          </b-form-select-option>
          <b-form-select-option value="æ¢¦ç¾½å®å¢ƒ">æ¢¦ç¾½å®å¢ƒ</b-form-select-option>
          <b-form-select-option value="æ—…äººæ ˆæ¡¥">æ—…äººæ ˆæ¡¥</b-form-select-option>
          <b-form-select-option value="ç™½é“¶ä¹¡">ç™½é“¶ä¹¡</b-form-select-option>
          <b-form-select-option value="ç™½é‡‘å¹»è±¡">ç™½é‡‘å¹»è±¡</b-form-select-option>
          <b-form-select-option value="æ‹‚æ™“ä¹‹é—´">æ‹‚æ™“ä¹‹é—´</b-form-select-option>
          <b-form-select-option value="ç¥æ‹³ç—•">ç¥æ‹³ç—•</b-form-select-option>
          <b-form-select-option value="é¾™å·¢ç¥æ®¿">é¾™å·¢ç¥æ®¿</b-form-select-option>
          <b-form-select-option value="æ½®é£äº­">æ½®é£äº­</b-form-select-option>
          <b-form-select-option value="è±†è±†æŸ´" style="font-weight: bold;font-style: italic;">è±†è±†æŸ´
          </b-form-select-option>
          <b-form-select-option value="é“¶æ³ªæ¹–">é“¶æ³ªæ¹–</b-form-select-option>
          <b-form-select-option value="ä¼Šä¿®åŠ å¾·">ä¼Šä¿®åŠ å¾·</b-form-select-option>
          <b-form-select-option value="çº¢èŒ¶å·">çº¢èŒ¶å·</b-form-select-option>
          <b-form-select-option value="å¤ªé˜³æµ·å²¸">å¤ªé˜³æµ·å²¸</b-form-select-option>
          <b-form-select-option value="æ°´æ™¶å¡”">æ°´æ™¶å¡”</b-form-select-option>
          <b-form-select-option selected value="ä¸­å›½" style="font-weight: bold;font-style: italic;">ä¸­å›½
          </b-form-select-option>
        </b-form-select>
        <b-form-select id="timeScale" v-model="scale">
          <b-form-select-option value="8">ç»Ÿè®¡8å°æ—¶</b-form-select-option>
          <b-form-select-option selected value="24">ç»Ÿè®¡24å°æ—¶</b-form-select-option>
          <b-form-select-option value="72">ç»Ÿè®¡3å¤©</b-form-select-option>
          <b-form-select-option value="168">ç»Ÿè®¡7å¤©</b-form-select-option>
          <b-form-select-option value="360">ç»Ÿè®¡15å¤©</b-form-select-option>
          <b-form-select-option value="720">ç»Ÿè®¡30å¤©</b-form-select-option>
        </b-form-select>
        <bt-select :options="itemTypeOptions" v-model="itemTypes" ref="typeSelect" id="itemType">
        </bt-select>
        <b-form-input min="0" placeholder="è‡³å°‘å”®å‡º" type="number" value=""
                      v-model="minQuantity"></b-form-input>
        <b-form-input id="min" min="0" placeholder="ä½ä»·" type="number" value=""
                      v-model="min"></b-form-input>
        <b-form-input id="max" placeholder="é«˜ä»·" type="number" value="" v-model="max"></b-form-input>
        <b-form-input id="search" class="mx-1" placeholder="æ¨¡ç³Šè¿‡æ»¤" type="text" v-model="searchText"></b-form-input>
        <b-form-select id="sortType" v-model="sortType">
          <b-form-select-option selected value="1">æŒ‰äº¤æ˜“æ¬¡æ•°æ’åº</b-form-select-option>
          <b-form-select-option value="2">æŒ‰å”®å‡ºæ€»æ•°æ’åº</b-form-select-option>
        </b-form-select>
        <b-button squared variant="outline-dark" class="mx-1" @click="filterMarketable()" type="button"><i
            class="bi bi-search"></i>
        </b-button>
        <b-button squared variant="outline-dark" @click="resetMarketable()" type="button"><i
            class="bi bi-arrow-clockwise"></i>
        </b-button>
        <b-button squared variant="outline-dark" class="mx-1" @click="openUpdateTimeTable()" type="button"><i
            class="bi bi-calendar-month"></i>
        </b-button>
      </b-form-group>
    </b-form>
    <div>
      <BootstrapTable id="marketableTable"
                      ref="table"
                      :columns="columns"
                      :options="tableOptions"
                      @on-post-body="vueFormatterPostBody"
      />
    </div>
    <div style="margin:0 auto;width: 12px;height: 12px">
      <a target="_blank" href="https://github.com/zhangjianfengv/ffbusiness_resources">
        <span><i class="bi bi-github"></i></span>
      </a>
    </div>
    <div aria-hidden="true" aria-labelledby="summaryTable" class="modal fade" id="summaryModal" role="dialog"
         tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title" style="margin: 0 auto" id="SummaryLabel"></h4>
          </div>
          <div class="modal-body">
            <div>
              <b-form-select class="modal-select" v-model="summaryScale" :options="summaryOptions"
                             @change="changeSummaryScale(summaryScale)"></b-form-select>
              <span>ğŸ“Œå‡ä»·å·²ç»å‰”é™¤æ•°å€¼è¶…å‡ºå¹³å‡å€¼åŠ ä¸Šæ ‡å‡†å·®çš„ä¸¤å€çš„æ•°æ®</span>
            </div>
            <LineChart v-if="loaded" :chart-data="chartData"/>
            <BarChart v-if="loaded" :chart-data="chartData1"/>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-dismiss="modal" @click="closeSummaryTable()" type="button"><i
                class="bi bi-power"></i></button>
          </div>
        </div>
      </div>
    </div>
    <div aria-hidden="true" aria-labelledby="myModalLabel" class="modal fade" id="myModal" role="dialog" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title" id="myModalLabel" style="margin: 0 auto">æ›´æ–°æ—¶é—´ä¸€è§ˆ</h4>
          </div>
          <div class="modal-body">
            <table id="updateTimeTable"></table>
          </div>
          <div class="modal-footer">
            <b-button squared variant="outline-dark" data-dismiss="modal" @click="closeUpdateTimeTable()" type="button">
              <i
                  class="bi bi-power"></i></b-button>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
<style scoped>
a, a:hover {
  color: #343a40;
}

.modal-select {
  width: 80px;
}

@media screen and (max-width: 1000px) {
  .modal {
    max-width: 100%; /* å½“è®¾å¤‡å®½åº¦å°äºæˆ–ç­‰äº600pxæ—¶ï¼Œå¼¹æ¡†å®½åº¦ä¸ºè®¾å¤‡å®½åº¦çš„100% */
    width: 400px; /* å½“è®¾å¤‡å®½åº¦å°äºæˆ–ç­‰äº600pxæ—¶ï¼Œå¼¹æ¡†å®½åº¦ä¸ºè®¾å¤‡å®½åº¦çš„100% */
  }
}

</style>
<script>
import tableMixin from '../mixins/table'
import $ from "jquery";
import Base64 from '../plugins/base64'
import LineChart from "@/components/LineChart.vue";
import BarChart from "@/components/BarChart.vue";
import moment from "moment";
import {initTooltip} from "@thewakingsands/kit-tooltip";

let queryMarketable = {
  worldName: 'ä¸­å›½',
  timeScale: 24
};
export default {
  mixins: [tableMixin],
  components: {
    LineChart, BarChart
  },
  props: ['themeColor'],
  data() {
    let color = this.themeColor;
    return {
      scale: 24,
      worldName: 'ä¸­å›½',
      min: null,
      max: null,
      sortType: "1",
      chartData: {},
      searchText: null,
      chartData1: {},
      summaryScale: '7',
      summaryItemId: null,
      summaryOptions: [
        {value: '3', text: '3å¤©'},
        {value: '7', text: '7å¤©'},
        {value: '15', text: '15å¤©'},
        {value: '30', text: '30å¤©'},
        {value: '90', text: '90å¤©'},
        {value: '180', text: '180å¤©'},
        {value: 'all', text: 'æ‰€æœ‰æ—¶é—´'}
      ],
      columns: [
        {
          field: '',
          title: 'åºå·',
          align: "center",
          formatter: function (value, row, index) {
            return index + 1;
          }
        }, {
          field: 'itemId',
          sortable: true,
          visible: false,
          title: 'ç‰©å“ID',
          filterControl: 'input'
        }, {
          field: 'name',
          sortable: true,
          formatter: function iconFormatter(value, row) {
            let url = "https://static.ff14pvp.top/icon/icon/" + row.itemId + '.png?eo-img.resize=w/32/h/32';
            return '<img src="' + url + '" decoding="async" width="32" height="32" alt="å›¾æ ‡">&nbsp;&nbsp;' + '<span data-ck-item-id="' + row.itemId + '">' + value + '</span>';
          },
          title: 'ç‰©å“åç§°'
        }, {
          field: 'quantity',
          sortable: true,
          formatter: (value) => {
            return this.formatNumber(value);
          },
          visible: false,
          title: 'å”®å‡ºæ•°',
        }, {
          field: 'num',
          sortable: true,
          formatter: (value) => {
            return this.formatNumber(value);
          },
          title: 'äº¤æ˜“æ¬¡æ•°',
        }, {
          field: 'numIndexCurrent',
          sortable: true,
          title: 'æ¬¡æ•°æ’åº'
        }, {
          field: 'numIndexChange',
          sortable: true,
          title: 'æ’åºè¾ƒä¸Šæ¬¡',
          formatter: function changeFormatter(value, row) {
            if (!$.isNumeric(row.quantityIndexChange)) return "æ— æ­¤ç‰©å“"
            else if (value === 0) return "æŒå¹³"
            else if (value > 0) return "<h4 style='display: inline;color: #1e7e34'>â†“</h4>&nbsp;" + value;
            else if (value < 0) return "<h4 style='display: inline; color: #b94a48'>â†‘</h4>&nbsp;" + (-value);
            else return "æ— æ­¤ç‰©å“"
          },
        }, {
          field: 'quantityIndexCurrent',
          sortable: true,
          visible: false,
          title: 'å”®å‡ºæ•°æ’åº'
        }, {
          field: 'quantityIndexChange',
          sortable: true,
          visible: false,
          title: 'æ’åºè¾ƒä¸Šæ¬¡',
          formatter: function changeFormatter(value) {
            if (value === 0) return "æŒå¹³"
            else if (value > 0) return "<h4 style='display: inline;color: #1e7e34'>â†“</h4>&nbsp;" + value;
            else if (value < 0) return "<h4 style='display: inline; color: #b94a48'>â†‘</h4>&nbsp;" + (-value);
            else return "æ— æ­¤ç‰©å“"
          },
        }, {
          field: 'pricePerUnit',
          sortable: true,
          formatter: (value) => {
            return this.formatNumber(value);
          },
          title: 'å‡ä»·'
        }, {
          field: 'craft',
          visible: false,
          filterControl: 'select',
          formatter: (value) => {
            return value === true ? 'âœ”' : 'âœ—'
          },
          title: 'å¯åˆ¶ä½œ'
        }, {
          field: 'itemTypeName',
          sortable: true,
          filterControl: 'select',
          visible: false,
          title: 'åˆ†ç±»'
        }, {
          field: 'itemLevel',
          sortable: true,
          visible: false,
          filterControl: 'select',
          title: 'å“çº§'
        }, {
          field: 'equipLevel',
          sortable: true,
          visible: false,
          filterControl: 'select',
          title: 'ç­‰çº§'
        }, {
          title: 'è¶‹åŠ¿å›¾',
          width: 100,
          formatter: (value, row) => {
            let template;
            if (row.quantityIndexChange < 0)
              template = '<b-button  squared variant="outline-dark" @click="clickRow(row)"><i class="bi bi-graph-up-arrow"></i></b-button>';
            else template = '<b-button  squared variant="outline-dark" @click="clickRow(row)"><i class="bi bi-graph-down-arrow"></i></b-button>'
            return this.vueFormatter({
              template: template,
              data: {row},
              methods: {
                clickRow: this.openSummary
              }
            })
          }
        }],
      itemTypes: [],
      loaded: false,
      itemTypeOptions: [],
      minQuantity: null,
      tableOptions: {
        url: '/ffbusiness/saleHistory/marketableData',
        search: true,
        searchAlign: 'left',
        searchSelector: '#search',
        toolbar: '#marketableForm',
        stickyHeader: true,
        stickyHeaderOffsetLeft: parseInt($('body').css('padding-left'), 10),
        stickyHeaderOffsetRight: parseInt($('body').css('padding-right'), 10),
        theadClasses: 'thead-light',
        sortName: "numIndexCurrent",
        sortOrder: 'asc',
        filterControl: true,
        method: 'post',
        paginationUseIntermediate: true,
        paginationSuccessivelySize: 1,
        paginationPagesBySide: 1,
        queryParams: function () {
          return queryMarketable;
        },
        columns: this.columns,
        pageList: [20, 100, 200, 500, 1000],
        pagination: "true",
        showColumns: true,
        showColumnsToggleAll: true,
        showExport: true,
        mobileResponsive: true,
        icons: {columns: 'bi bi-list-ul', export: "bi bi-download"},
        contentType: "application/json",
        onAll: function () {
          let $columns = $('.columns');
          $columns.removeClass('float-right')
          $columns.removeClass('columns')
          let form = $('#marketableForm>fieldset.form-group>div');
          form.append($columns);
          $('.fixed-table-toolbar>div:not(:first)').remove();
          if (form.children().length > 12) form.children().last().remove();//TODO é­”æ³•å€¼
          const otherLinks = document.querySelectorAll('.page-link');
          if (otherLinks) {
            otherLinks.forEach(link => {
              link.style.textDecoration = 'none';
              link.style.borderRadius = '0 !important';
              link.style.color = 'black';
              link.style.borderColor = color;
              link.style.backgroundColor = 'white';
            });
          }
          const active = document.querySelector('.pagination .page-item.active .page-link');
          if (active) {
            active.style.color = 'white';
            active.style.borderColor = color;
            active.style.backgroundColor = color;
          }
        }
      },
    }
  },
  methods: {
    filterMarketable() {
      const $marketableTable = $('#marketableTable');
      const timeScale = this.scale;
      queryMarketable = {
        worldName: $('#worldName').val(),
        timeScale: timeScale,
        max: $('#max').val(),
        min: $('#min').val(),
        minQuantity: this.minQuantity,
        itemTypes: this.itemTypes
      };
      this.sortType = "1";
      $marketableTable.bootstrapTable('refresh', {
        query: queryMarketable
      });
    },
    resetMarketable() {
      let $itemType = $('#itemType');
      let $marketableTable = $('#marketableTable');
      $('#marketableForm')[0].reset();
      this.scale = 24;
      this.worldName = 'ä¸­å›½';
      this.min = null;
      this.max = null;
      this.sortType = "1";
      this.itemTypes = [];
      this.minQuantity = null;
      $itemType.selectpicker('val', []);
      $itemType.selectpicker('refresh');
      this.searchText = null;
      queryMarketable = {
        worldName: 'ä¸­å›½',
        timeScale: 24
      };
      $marketableTable.bootstrapTable('refreshOptions', this.tableOptions);
    },
    openUpdateTimeTable() {
      $('#myModal').modal('show');
      let format = "yyyy-MM-DD";
      $('#updateTimeTable').bootstrapTable({
        url: '/ffbusiness/saleHistory/marketableUpdateTime',
        columns: [{
          field: 'scale',
          title: 'ç»Ÿè®¡å‘¨æœŸ',
          formatter: function (value) {
            return $('#timeScale option[value=' + value + ']').html().slice(2);
          }
        }, {
          title: 'æ›´æ–°äº',
          formatter: function (value, row) {
            let s = row.end.substring(0, 19);
            let today = moment().format(format) === row.end.substring(0, 10);
            if (row.scale / 24 > 1) {
              s = s.substring(0, 10)
              if (today)
                return '<span style="color: #17a2b8;">' + s + '</span>';
              return s;
            } else return s;
          }
        }, {
          field: 'next',
          title: 'ä¸‹æ¬¡æ›´æ–°',
          formatter: function (value, row) {
            if (row.scale / 24 > 1) {
              value = value.substring(0, 10)
            }
            return value;
          }
        }], method: 'post',
        contentType: "application/json"
      });
    },
    openSummary(row) {
      let url = "https://static.ff14pvp.top/icon/icon/" + row.itemId + '.png?eo-img.resize=w/32/h/32';
      $('#SummaryLabel').html(this.worldName + '&nbsp;<img src="' + url +
          '" decoding="async" width="32" height="32" alt="å›¾æ ‡">' + row.name + '&nbsp;è¶‹åŠ¿')
      $('#summaryModal').modal('show');
      this.summaryItemId = row.itemId;
      this.changeSummaryScale(this.summaryScale);
    },
    changeSummaryScale(scale) {
      const vm = this;
      let format = "yyyyMMDD";
      $.ajax({
        url: "/ffbusiness/summary/query", method: "post",
        data: JSON.stringify({
          itemId: vm.summaryItemId,
          startDate: scale === "all" ? '20230209' : moment().subtract(parseInt(scale), 'days').format(format),
          endDate: moment().format(format),
          worldName: vm.worldName
        }),
        contentType: "application/json", success: function (data) {
          let labels = data.dates;
          let realLabels = [];
          for (let l of labels) {
            realLabels.push(moment(l).subtract(1, "days").format(format));//å› ä¸ºåç«¯æ—¥æœŸæ€»æ˜¯åŠ ä¸€å¤©
          }
          let priceData = data.values[0].value;
          const mean = priceData.reduce((acc, val) => acc + val, 0) / priceData.length;
          const stdDev = Math.sqrt(priceData.reduce((acc, val) => acc + Math.pow(val - mean, 2), 0) / priceData.length);
          // å®šä¹‰é˜ˆå€¼ä¸ºå¹³å‡å€¼åŠ ä¸Šæ ‡å‡†å·®çš„ä¸¤å€
          const threshold = mean + (2 * stdDev);
          // å°†è¶…å‡ºé˜ˆå€¼çš„æ•°æ®ç‚¹æ›¿æ¢ä¸ºnull
          const filteredData = priceData.map(value => value > threshold ? null : value);
          vm.chartData = {
            labels: realLabels,
            datasets: [
              {
                label: 'å‡ä»·',
                backgroundColor: '#df9ba1',
                data: filteredData
              }
            ]
          };
          vm.loaded = true;
          vm.chartData1 = {
            labels: realLabels,
            datasets: [
              {
                label: 'å”®å‡ºæ•°',
                backgroundColor: '#5ba585',
                data: data.values[1].value
              }
            ]
          };
          vm.loaded = true;
        }
      });
    },
    formatNumber(number) {
      return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    },
    closeUpdateTimeTable() {
      $('#myModal').modal('toggle');
    }, closeSummaryTable() {
      $('#summaryModal').modal('toggle');
    }, isStr(val) {
      return val !== null && val !== undefined && val !== '' && val.replace(/(^s*)|(s*$)/g, "").length !== 0;
    }
  },
  mounted() {
    initTooltip({
      context: {
        apiBaseUrl: 'https://' + window.location.hostname + '/ffbusiness/cafe/item',  // xivapi æˆ– cafemaker çš„ urlï¼›æœ€åä¸è¦æœ‰æ–œçº¿
        iconBaseUrl: 'https://' + window.location.hostname + '/ffbusiness/cafe/i', // å›¾æ ‡ cdn çš„ urlï¼›æœ€åä¸è¦æœ‰æ–œçº¿
        defaultHq: true,  // æ˜¯å¦é»˜è®¤æ˜¾ç¤º HQ æ•°æ®
        hideSeCopyright: false, // æ˜¯å¦éšè— SE ç‰ˆæƒä¿¡æ¯
      },
      links: {
        detectWikiLinks: true,  // æ˜¯å¦è‡ªåŠ¨è¯†åˆ« wiki ç‰©å“é“¾æ¥
        itemNameAttribute: 'data-ck-item-name', // è‡ªå®šä¹‰æ‚¬æµ®çª—æ—¶ï¼Œå£°æ˜ç‰©å“åå­—çš„å±æ€§
        itemIdAttribute: 'data-ck-item-id', // è‡ªå®šä¹‰æ‚¬æµ®çª—æ—¶ï¼Œå£°æ˜ç‰©å“ ID çš„å±æ€§
        actionNameAttribute: 'data-ck-action-name', // è‡ªå®šä¹‰æ‚¬æµ®çª—æ—¶ï¼Œå£°æ˜æŠ€èƒ½åå­—çš„å±æ€§
        actionIdAttribute: 'data-ck-action-id', // è‡ªå®šä¹‰æ‚¬æµ®çª—æ—¶ï¼Œå£°æ˜æŠ€èƒ½ ID çš„å±æ€§
        rootContainer: document.body, // ç›‘æ§çš„æ ¹å…ƒç´ 
      },
    })
    $('#itemType').selectpicker();
    const worldCookie = this.$cookies.get('world');
    if (this.isStr(worldCookie)) {
      this.worldName = Base64.decode(worldCookie);
    }
    let $sortType = $('#sortType');
    $sortType.change(function () {
      let $sortType1 = $('#sortType');
      let val = $sortType1.val();
      let table = $("#marketableTable");
      table.bootstrapTable('refreshOptions', {
        sortOrder: 'asc',
        sortName: val === '2' ? 'quantityIndexCurrent' : 'numIndexCurrent',
        columns: this.columns
      })
      if (val === '2') {
        table.bootstrapTable('showColumn', 'quantityIndexCurrent');
        table.bootstrapTable('showColumn', 'quantityIndexChange');
        table.bootstrapTable('showColumn', 'quantity');
        table.bootstrapTable('hideColumn', 'numIndexCurrent');
        table.bootstrapTable('hideColumn', 'num');
        table.bootstrapTable('hideColumn', 'numIndexChange');
      } else {
        table.bootstrapTable('showColumn', 'numIndexCurrent');
        table.bootstrapTable('showColumn', 'numIndexChange');
        table.bootstrapTable('showColumn', 'num');
        table.bootstrapTable('hideColumn', 'quantityIndexCurrent');
        table.bootstrapTable('hideColumn', 'quantityIndexChange');
        table.bootstrapTable('hideColumn', 'quantity');
      }
    })
  }
}
</script>